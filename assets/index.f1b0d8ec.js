var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l;"undefined"!=typeof require&&require;import{l as o,y as a,D as c,v as s,r as i,L as u,R as d,a as g,S as p}from"./vendor.9510d0c2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const v="https://pdapi.vladb.xyz",h=(e,t)=>({root:v,fetchAllSchedules:`${v}/v2/schedules`,fetchSchedule:`${v}/v2/schedule/${t?"live/":""}${null!=e?e:""}`}),f=()=>Math.floor(new Date((new Date).getTime()+60*(()=>{const e=new Date;return e.getTimezoneOffset()<(()=>{const e=new Date(0,1),t=new Date(6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())})()?-5:-4})()*60*1e3).getTime()/1e3),w=e=>{const[t,n]=o((()=>localStorage.getItem(e))),l=()=>{const l=localStorage.getItem(e);l!==t&&n(l)};return a((()=>{const t=t=>{t.storageArea===localStorage&&t.key===e&&n(t.newValue)},r=t=>{t.detail.key===e&&l()};return window.addEventListener("storage",t),window.addEventListener("customStorageChange",r),()=>{window.removeEventListener("storage",t),window.removeEventListener("customStorageChange",r)}})),a((()=>{t?localStorage.setItem(e,t):localStorage.removeItem(e),window.dispatchEvent(new CustomEvent("customStorageChange",{detail:{key:e}})),l()}),[e,t]),[t,n]},m=c({}),x=({children:e})=>{const[t,n]=o({currentSlot:null,schedule:null,overwriteMessage:null,now:new Date}),[l]=w("schedule_id"),[r]=w("live_schedule");return a((()=>{l?(async(e,t)=>{console.log("downloading data");const{fetchSchedule:n}=h(e,t),l=await fetch(n);return await l.json()})(l,"true"===r).then((e=>{console.log("setting"),setInterval((()=>(e=>{if(!e)return console.log("no data",e);const t=(new Date).getDay(),l=e[(0===t?6:t-1).toString()],r=f(),o=r%86400;let a;if(l.forEach((e=>{e.start<=o&&e.end>=o&&(a=e)})),!a)return alert("Failure to generate now, please report to vlad!"),console.log(a,o,r,l),n({schedule:e,now:new Date,overwriteMessage:"Failed to generate current slot",currentSlot:null});n({schedule:e,currentSlot:a,overwriteMessage:null,now:new Date})})(e)),250)})).catch((()=>{console.log("failed load?!")})):n({schedule:null,currentSlot:null,overwriteMessage:"Please select a schedule in the settings menu",now:new Date})}),[l]),s(m.Provider,{value:t},e)},y=e=>o=>{var a=((e,r)=>{var o={};for(var a in e)n.call(e,a)&&r.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&t)for(var a of t(e))r.indexOf(a)<0&&l.call(e,a)&&(o[a]=e[a]);return o})(o,[]);return s(m.Consumer,null,(o=>s(e,((e,o)=>{for(var a in o||(o={}))n.call(o,a)&&r(e,a,o[a]);if(t)for(var a of t(o))l.call(o,a)&&r(e,a,o[a]);return e})({data:o},a))))};var b=y((({display:e,data:t})=>{const{overwriteText:n,counter:l}=(e=>{if(e.overwriteMessage)return{overwriteText:e.overwriteMessage,counter:null};if(!e.currentSlot)return console.log("no data",e),{overwriteText:"Loading...",counter:null};const t=f()%86400,n=1e3*(e.currentSlot.end-t);return{overwriteText:"",counter:new Date((new Date).getTime()+n)}})(t);return s(e,{end:l,overwriteText:n})}));var S=y((({display:e,data:t})=>{var n;let l;return l=(null==(n=t.currentSlot)?void 0:n.eventName)?t.currentSlot.eventName:t.overwriteMessage?t.overwriteMessage:"Loading...",s(e,{text:l})}));const k=({children:e})=>s("div",{class:"text-center flex flex-col min-h-screen items-center justify-center p-[20px]"},e),O=({children:e})=>s("div",{class:"flex flex-row justify-between items-stretch"},e),M=({children:e,location:t,isSticky:n=!1})=>s("div",{class:`${n?"fixed":"absolute"} top-[13px] ${"right"===t?"right-[13px]":""} ${"left"===t?"left-[13px]":""}`},e),C=({text:e,children:t,subtext:n})=>s("div",{class:"pb-[40px]"},s("h2",{class:"text-[30px] font-bold "+(n?"":"pb-[10px]")},e),n?s("p",{class:"pb-[10px]"},n):null,s("div",{class:"text-center flex flex-col items-center justify-center space-y-[10px]"},t)),D=({icon:e,alt:t,url:n})=>s("img",{src:e,alt:t,class:"w-[30px] h-[30px]",onClick:()=>{n&&i(n,!1)}}),L=({children:e})=>s("div",{class:"flex flex-row items-center justify-center space-x-1"},e),E=({children:e,color:t})=>s("div",{style:{backgroundColor:t}},e);var T="_gradient_1v12f_1";const j=({children:e})=>s("div",{class:T},e),$=({children:e})=>{var t;const{background:n}=(()=>{const[e]=w("background");return{background:e?JSON.parse(e):null}})();switch(null==n?void 0:n.background){case"color":return s(E,{color:null==(t=n.data)?void 0:t.color},e);case"gradient":return s(j,null,e);default:return s(E,{color:"#282c34"},e)}},N=({end:e,overwriteText:t})=>{const[n,l]=o(""),r=()=>{if(t)return l(t);const n=Math.floor((e.valueOf()-(new Date).valueOf())/1e3),r=Math.abs(n);let o="";r/3600>=1&&(o+=`${Math.floor(r/3600)}h`),r/60>=1&&(o+=` ${Math.floor(Math.floor(r%3600)/60)}m`),o+=` ${r%60}s`,o=`${n<0?"-":""}${o.trim()}`,l(o)};return a((()=>{r();const e=setInterval(r,1e3);return()=>{clearInterval(e)}})),s("p",{class:"text-[80px] pb-[10px] text-white"},n)};var I=y((({data:e})=>s("p",{class:"text-[20px] pt-[5px] text-white"},e.now.toLocaleString())));const B=({text:e})=>s("p",{class:"text-[25px] text-white"},e),P=()=>s($,null,s(O,null,s(M,{location:"left"},s(D,{icon:"/assets/cog-solid.a1bf6849.svg",alt:"Settings",url:"/settings"})),s(M,{location:"right"},s(I,null))),s(k,null,s(b,{display:N}),s(S,{display:B}))),_=()=>s("div",{class:"text-center"},s("h1",null,"Error 404"),s("p",null,"That page doesn't exist."),s("h4",null,"Back to"," ",s(u,{href:"/",class:"text-blue-600"},"Home")));const J=()=>{const[e,t]=o(null),[n,l]=w("schedule_id");return a((()=>{(async()=>{console.log("fetching all schedules");const{fetchAllSchedules:e}=h(),t=await fetch(e);return await t.json()})().then((e=>{const n={};e.forEach((e=>{n[e.group]||(n[e.group]=[]),n[e.group].push(e)})),t(n)})).catch((()=>{console.log("Failed to fetch data")}))}),[]),s("select",{onChange:e=>{var t;l(null==(t=e.target)?void 0:t.value)}},null===n?s("option",{selected:!0,value:void 0},"Please select a schedule"):null,e?Object.keys(e).map((t=>{var l;return s("optgroup",{label:t,key:t},null==(l=e[t])?void 0:l.map((e=>s("option",{key:e.id,selected:n===e.id,value:e.id},e.name))))})):s("option",null,"Loading"))},z=({background:e,setBackground:t})=>{var n,l;const r=e?JSON.parse(e):null,[a,c]=o(null!=(l=null==(n=null==r?void 0:r.data)?void 0:n.color)?l:"#282c34"),i="color"===(null==r?void 0:r.background);return s(L,null,s("input",{type:"radio",checked:i,onChange:e=>{var n;"on"===(null==(n=e.target)?void 0:n.value)&&t(JSON.stringify({background:"color",data:{color:a}}))}}),s("input",{type:"color",value:a,onChange:e=>{t(JSON.stringify({background:"color",data:{color:e.target.value}})),c(e.target.value)}}),s("p",null,"Custom Color"))},A=({background:e,setBackground:t})=>{const n=e?JSON.parse(e):null,l="gradient"===(null==n?void 0:n.background);return s(L,null,s("input",{type:"radio",checked:l,onChange:e=>{var n;"on"===(null==(n=e.target)?void 0:n.value)&&t(JSON.stringify({background:"gradient"}))}}),s("p",null,"Gradient"))},F=()=>{const[e,t]=w("background");return s("div",null,s(z,{background:e,setBackground:t}),s("p",null,"or"),s(A,{background:e,setBackground:t}))},q=()=>{const[e,t]=w("live_schedule");return s("div",null,s(L,null,s("input",{type:"checkbox",checked:"true"===e,onChange:e=>{var n;t(null==(n=e.target)?void 0:n.checked.toString())}}),s("p",null,"Live Schedule")),s("p",null,"Schedule updates are downloaded automatically for days with early dismissals / delayed starts / etc. "))},G=()=>s("div",null,s(O,null,s(M,{location:"right",isSticky:!1},s(D,{icon:"/assets/times-solid.115f5fad.svg",alt:"Go Back",url:"/"}))),s(k,null,s(C,{text:"Select a Schedule"},s(J,null)),s(C,{text:"Styling / Background"},s(F,null)),s(C,{text:"Experimental",subtext:"Features that are not finalized (but functional)"},s(q,null))));p(s((()=>s(x,null,s(d,null,s(g,{path:"/",component:P}),s(g,{path:"/settings",component:G}),s(g,{default:!0,component:_})))),null),document.getElementById("app"));
